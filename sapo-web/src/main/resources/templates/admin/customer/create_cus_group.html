<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi-VN" class="sapo-menu-expand sapo-menu-toggle-active">
<head>
    <title>Thêm Nhóm khách hàng</title>

    <th:block th:replace="/layout/header"/>

    <link rel="stylesheet" href="/assets/admin/css/customer/cus_group.css"/>
</head>
<body>
<th:block th:replace="/layout/menu"/>
<div class="jss64 jss40">
    <div>
        <div class="jss10118">
            <div class="jss10121">
                <a class="MuiTypography-root MuiLink-underlineNone jss23596 MuiTypography-colorSecondary"
                   href="/admin/customer_groups">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                         class="jss23597">
                        <path d="M14.298 5.99 8.288 12l6.01 6.01 1.414-1.414L11.116 12l4.596-4.596-1.414-1.414Z"
                              fill="currentColor">
                        </path>
                    </svg>
                    <h6 class="MuiTypography-root MuiTypography-subtitle1">
                        Quay lại danh sách nhóm khách hàng
                    </h6>
                </a>
            </div>
            <div class="jss20296">
                <button type="button" class="ldZiUT ldZabc" href="/admin/customer_groups">
                    Hủy
                </button>
                <button id="btnCreateCustomerGroup" class="RthGc ldZabc" type="button">
                        <span class="cMXJOk">
                            Lưu
                        </span>
                </button>
            </div>
        </div>
    </div>
    <form id="frmCreateCusGrp">
        <div class="jss608">
            <div class="MuiGrid-container MuiGrid-spacing-xs-3">
                <div class="MuiGrid-item MuiGrid-grid-xs-6">
                    <div class="MuiPaper-root jss23708 MuiPaper-elevation1 MuiPaper-rounded">
                        <div class="jss751 jss722 borderBottom">
                            <div>
                                <h6 class="MuiTypography-root jss24250 ">
                                    Thông tin chung
                                </h6>
                            </div>
                        </div>
                        <div class="jss23712">
                            <div class="MuiGrid-container MuiGrid-spacing-xs-2">
                                <div class="MuiGrid-item MuiGrid-grid-xs-12">
                                    <div class="MuiFormControl-root jss754 MuiFormControl-fullWidth">
                                        <label class="MuiFormLabel-root MuiInputLabel-root jss755
                                        MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-shrink"
                                               data-shrink="true" for="titleGroupCre">
                                            Tên nhóm
                                            <span class="MuiFormLabel-asterisk MuiInputLabel-asterisk">
                                                &thinsp;*
                                            </span>
                                        </label>
                                        <div class="MuiFormControl-root jss756 MuiFormControl-fullWidth"
                                             field="[object Object]" form="[object Object]">
                                            <div class="MuiInputBase-root MuiOutlinedInput-root MuiInputBase-fullWidth">
                                                <div class="MuiInputBase-fullWidth">
                                                    <input aria-invalid="false"
                                                           id="titleGroupCre"
                                                           name="titleGroupCre"
                                                           placeholder="Nhập tên nhóm khách hàng"
                                                           type="text"
                                                           aria-label="Without label"
                                                           class="MuiInputBase-input MuiOutlinedInput-input placeholder_text"
                                                           fdprocessedid="7i85i6">
                                                </div>
                                                <fieldset aria-hidden="true"
                                                          class="jss823 MuiOutlinedInput-notchedOutline">
                                                    <legend class="jss824">
                                                    </legend>
                                                </fieldset>
                                            </div>
<!--                                            error container, dont remove-->
                                            <div class="error titleGroupCre-error"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="MuiGrid-item MuiGrid-grid-xs-12">
                                    <div class="MuiFormControl-root jss754 MuiFormControl-fullWidth">
                                        <label class="MuiFormLabel-root MuiInputLabel-root jss755 MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-shrink"
                                               data-shrink="true" for="cusGrpCode">
                                            Mã nhóm</label>
                                        <div class="MuiFormControl-root jss756 MuiFormControl-fullWidth"
                                             field="[object Object]" form="[object Object]">
                                            <div class="MuiInputBase-root MuiOutlinedInput-root MuiInputBase-fullWidth">
                                                <input aria-invalid="false"
                                                       id="cusGrpCode"
                                                       name="cusGrpCode"
                                                       placeholder="Nhập mã nhóm khách hàng" type="text"
                                                       aria-label="Without label"
                                                       class="MuiInputBase-input MuiOutlinedInput-input placeholder_text"
                                                       fdprocessedid="sytfp">
                                                <fieldset aria-hidden="true"
                                                          class="jss823 MuiOutlinedInput-notchedOutline">
                                                    <legend class="jss824">
                                                    </legend>
                                                </fieldset>
                                            </div>
                                        </div>
                                        <div class="error cusGrpCode-error"></div>
                                    </div>
                                </div>
                                <div class="MuiGrid-item MuiGrid-grid-xs-12">
                                    <div class="MuiFormControl-root jss754 MuiFormControl-fullWidth">
                                        <label data-shrink="true" for="description"
                                               class="MuiFormLabel-root MuiInputLabel-root jss755 MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-shrink">
                                            Mô tả
                                            <span class="MuiTypography-root MuiTypography-caption"
                                                  title="Mô tả khách hàng của bạn để phục vụ cho việc chăm sóc khách hàng tốt hơn">
                                                <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"
                                                     width="16" height="16" color="primary" class="jss23713">
                                                    <path fill="#0088FF"
                                                          d="M7.4 5v1.2h1.2V5H7.4ZM7.4 8.6V11h1.8V9.8h-.6V7.4H6.8v1.2h.6Z">
                                                    </path>
                                                    <path fill-rule="evenodd" clip-rule="evenodd" fill="#0088FF"
                                                          d="M8 2C4.688 2 2 4.688 2 8s2.688 6 6 6 6-2.688 6-6-2.688-6-6-6ZM3.2 8c0 2.646 2.154 4.8 4.8 4.8s4.8-2.154 4.8-4.8S10.646 3.2 8 3.2A4.806 4.806 0 0 0 3.2 8Z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </label>
                                        <div class="MuiFormControl-root jss757 jss756 MuiFormControl-fullWidth"
                                             field="[object Object]" form="[object Object]">
                                            <div class="MuiInputBase-root MuiOutlinedInput-root MuiInputBase-fullWidth MuiInputBase-multiline MuiOutlinedInput-multiline">
                                                <textarea aria-invalid="false" id="description" rows="3"
                                                          aria-label="Without label" name="description"
                                                          class="MuiInputBase-input MuiOutlinedInput-input MuiInputBase-inputMultiline MuiOutlinedInput-inputMultiline placeholder_text">
                                                </textarea>
                                                <fieldset aria-hidden="true"
                                                          class="jss823 MuiOutlinedInput-notchedOutline">
                                                    <legend class="jss824">
                                                        <span>&ZeroWidthSpace;</span>
                                                    </legend>
                                                </fieldset>
                                            </div>
                                        </div>
                                        <div class="error description-error"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="MuiGrid-item MuiGrid-grid-xs-6">
                    <div class="MuiPaper-root jss721 MuiPaper-elevation1 MuiPaper-rounded">
                        <div class="jss751 jss722 borderBottom">
                            <div class="jss1769">
                                <h6 class="MuiTypography-root jss24250">
                                    Cài đặt nâng cao
                                </h6>
                                <button class="MuiButtonBase-root MuiIconButton-root jss723" tabindex="0" type="button"
                                        title="Cài đặt nâng cao" fdprocessedid="dazdea">
                                    <span class="MuiIconButton-label">
                                        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"
                                             width="16" height="16" color="primary" class="jss724">
                                            <path fill="#0088FF"
                                                  d="M7.4 5v1.2h1.2V5H7.4ZM7.4 8.6V11h1.8V9.8h-.6V7.4H6.8v1.2h.6Z">
                                            </path>
                                            <path fill-rule="evenodd" clip-rule="evenodd" fill="#0088FF"
                                                  d="M8 2C4.688 2 2 4.688 2 8s2.688 6 6 6 6-2.688 6-6-2.688-6-6-6ZM3.2 8c0 2.646 2.154 4.8 4.8 4.8s4.8-2.154 4.8-4.8S10.646 3.2 8 3.2A4.806 4.806 0 0 0 3.2 8Z">
                                            </path>
                                        </svg>
                                    </span>
                                    <span class="MuiTouchRipple-root">
                                    </span>
                                </button>
                            </div>
                        </div>
                        <div class="jss23712">
                            <div class="MuiGrid-container MuiGrid-spacing-xs-2">
                                <div class="MuiGrid-item MuiGrid-grid-xs-12">
                                    <div class="MuiFormControl-root jss754 MuiFormControl-fullWidth">
                                        <label class="MuiFormLabel-root MuiInputLabel-root jss755 MuiInputLabel-formControl
                                        MuiInputLabel-animated MuiInputLabel-shrink" data-shrink="true"
                                               for="searchDefaultPriceDropdown">
                                            Giá Mặc Định
                                        </label>
                                        <div class="dropdown jss1784 jss1769"
                                             onclick="CustomerApp.page.commands.showDefaultPriceDropdown()"
                                             id="defaultPriceContainer">
                                            <p id="selectedPriceDefault">Chọn giá mặc định</p>
                                        </div>
                                        <div id="defaultPriceDropdown" class="dropdown-content">
                                            <div>
                                                <div class="jss23596">
                                                    <div class="jss23775 jss23769">
                                                        <i class="fa-solid fa-magnifying-glass"></i>
                                                    </div>
                                                    <div class="MuiGrid-container">
                                                        <input type="text" placeholder="Tìm kiếm" class="jss23784"
                                                               id="searchDefaultPriceDropdown"
                                                               onkeyup="CustomerApp.page.commands.searchDefaultPriceDropdown()">
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                 onclick="CustomerApp.page.commands.showModalCreatePricePolicy()">
                                                <div class="jss23596">
                                                    <div class="jss23775 jss23769 jss760">
                                                        <i class="fa-solid fa-circle-plus"></i>
                                                    </div>
                                                    <span class="jss760 jss754">Thêm mới chính sách giá</span>
                                                </div>
                                            </div>
                                            <div id="listPricePolicy" class=" jss23783"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="MuiGrid-item MuiGrid-grid-xs-12">
                                    <div class="MuiFormControl-root jss754 MuiFormControl-fullWidth">
                                        <label class="MuiFormLabel-root MuiInputLabel-root jss755 MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-shrink"
                                               data-shrink="true" for="discount">
                                            Chiết khấu (%)
                                        </label>
                                        <div class="MuiFormControl-root jss756 MuiFormControl-fullWidth"
                                             field="[object Object]" form="[object Object]">
                                            <div class="MuiInputBase-root MuiOutlinedInput-root MuiInputBase-fullWidth ">
                                                <input aria-invalid="false"
                                                       id="discount" name="discount"
                                                       type="text" aria-label="Without label"
                                                       class="MuiInputBase-input MuiOutlinedInput-input jss758 placeholder_text"
                                                       placeholder="0"
                                                       fdprocessedid="16ju8f">
                                                <fieldset aria-hidden="true" class="jss823 MuiOutlinedInput-notchedOutline">
                                                    <legend class="jss824"></legend>
                                                </fieldset>
                                            </div>
                                        </div>
                                        <div class="error discount-error"></div>
                                    </div>
                                </div>
                                <div class="MuiGrid-item MuiGrid-grid-xs-12">
                                    <div class="MuiFormControl-root jss754 MuiFormControl-fullWidth">
                                        <label class="MuiFormLabel-root MuiInputLabel-root jss755
                                               MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-shrink"
                                               data-shrink="true" for="paymentType">
                                            Hình Thức Thanh Toán
                                        </label>
                                        <div class="dropdown jss1784">
                                            <div class="dropdown-toggle select-btn-pay jss759"
                                                 type="button" data-bs-toggle="dropdown"
                                                 aria-expanded="false">
                                                <span id="paymentType">
                                                    Chọn hình thức thanh toán
                                                </span>
                                            </div>
                                            <ul class="dropdown-menu w-100 showAllPaymentMethod">
                                                <li class="jss760 jss761">Chọn hình thức thanh toán</li>
                                                <div id="dropdownPaymentMethod">

                                                </div>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

</body>
<th:block th:replace="/admin/customer/modal_createPricePolicy"/>
<th:block th:replace="/layout/script"/>
<script src="/assets/admin/js/customer/customerGroup_App.js"></script>

<script src="/assets/admin/js/customer/customer_app.js"></script>

<script>
    let pricingPolicy = {
        title: '',
        pricingPolicyCode: '',
        pricingPolicyType: ''
    };
    let paymentMethod;
    let createCusGroupParam = new CustomerGroup();

    CustomerApp.page.elements.modalCreatePricePolicy = $("#modalCreatePricePolicy");

    CustomerApp.page.elements.titleGroupCre = $("#titleGroupCre");
    CustomerApp.page.elements.selectBtnPri = $('.select-btn-pri');
    CustomerApp.page.elements.selectBtnPay = $('.select-btn-pay');
    CustomerApp.page.elements.pricingType = $("#pricingType");

    CustomerApp.page.elements.btnCreateCustomerGroup = $("#btnCreateCustomerGroup");
    CustomerApp.page.elements.btnCreatePricePolicy = $("#btnCreatePricePolicy");
    CustomerApp.page.elements.btnCloseCreatePricePolicyModal = $(".btnCloseCreatePricePolicyModal");

    CustomerApp.page.elements.frmCreateCusGrp = $("#frmCreateCusGrp");
    CustomerApp.page.elements.frmCreatePricePolicy = $("#frmCreatePricePolicy");

    CustomerApp.page.elements.dropdownDefaultPrice = $("#dropdownDefaultPrice");
    CustomerApp.page.elements.dropdownPaymentMethod = $("#dropdownPaymentMethod");

    CustomerApp.page.elements.cusGrpCode = $("#cusGrpCode");
    CustomerApp.page.elements.description = $("#description");
    CustomerApp.page.elements.discount = $("#discount");
    CustomerApp.page.elements.paymentType = $("#paymentType");
    CustomerApp.page.elements.defaultPriceDropdown = $("#defaultPriceDropdown");
    CustomerApp.page.elements.searchDefaultPriceDropdown = $("#searchDefaultPriceDropdown");
    CustomerApp.page.elements.titlePricePolicyCre = $("#titlePricePolicyCre");
    CustomerApp.page.elements.pricingPolicyCodeCre = $("#pricingPolicyCodeCre");
    CustomerApp.page.elements.selectedPriceDefault = $("#selectedPriceDefault");
    CustomerApp.page.elements.listPricePolicy = $("#listPricePolicy");

    CustomerApp.page.elements.error = $(".error");
    CustomerApp.page.elements.titleError = $(".title-error.error");
    CustomerApp.page.elements.pricingPolicyCodeError = $(".pricingPolicyCode-error.error");
    CustomerApp.page.elements.pricingPolicyTypeError = $(".pricingPolicyType-error.error");

    CustomerApp.page.elements.titleGroupCreError = $(".titleGroupCre-error.error");
    CustomerApp.page.elements.cusGrpCodeError = $(".cusGrpCode-error.error");
    CustomerApp.page.elements.descriptionError = $(".description-error.error");
    CustomerApp.page.elements.discountError = $(".discount-error.error");


    CustomerApp.page.commands.showModalCreatePricePolicy = () => {
        CustomerApp.page.elements.modalCreatePricePolicy.modal("show");
    }

    CustomerApp.page.commands.selectPricePolicy = () => {
        $(".selectPricePolicy").on('click', function () {
            createCusGroupParam.pricingPolicyId = $(this).data('id');
            let value = $(this).data('value');

            CustomerApp.page.elements.selectedPriceDefault.text(value);
            CustomerApp.page.elements.defaultPriceDropdown[0].classList.toggle("show")
        })
    }

    // Lấy List Pricing default
    CustomerApp.page.commands.getAllPricingPolicy = () => {
        return $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
<<<<<<< HEAD
            url: origin +"/api/pricing-policies"
=======
            url: origin + "/api/pricingPolicys"
>>>>>>> 1839f2e0f3941be51a38ccbca6f4385ee3045bee
        })
            .done((data) => {
                data.forEach(item => {
                    let str = `<a class="jss23775 selectPricePolicy" data-id="${item.id}" data-value="${item.title}">
                                    ${item.title}
                                </a>`;

                    CustomerApp.page.elements.listPricePolicy.prepend(str);
                });
                CustomerApp.page.commands.selectPricePolicy();
            })
            .fail((jqXHR) => {
                console.log(jqXHR)
            })
    }

    // Lấy List Payment Method
    CustomerApp.page.commands.getAllPaymentMethod = () => {
        return $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: origin + "/api/admin/payment_methods"
        })
            .done((data) => {
                data.forEach(item => {
                    let str = `<li data-id="${item.id}" class="catItem dropdown-item jss761 selectedPaymentMethod">${item.title}</li>`;

                    CustomerApp.page.elements.dropdownPaymentMethod.append(str);
                });
                CustomerApp.page.commands.selectPaymentMethod();
            })
            .fail((jqXHR) => {
                console.log(jqXHR)
            })
    }

    CustomerApp.page.commands.selectPaymentMethod = () => {
        $(".selectedPaymentMethod").click(function () {
            createCusGroupParam.paymentMethodId = $(this).data('id');
        })
    }

    //create price policy
    CustomerApp.page.commands.createPricePolicy = () => {
        pricingPolicy = {
            title: CustomerApp.page.elements.titlePricePolicyCre.val().trim(),
            pricingPolicyCode: CustomerApp.page.elements.pricingPolicyCodeCre.val().trim(),
            pricingPolicyType: $('input[name="policyStyle"]:checked').val()
        }

        $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "POST",
            url: origin + "/api/pricingPolicys",
            data: JSON.stringify(pricingPolicy)
        }).done((data) => {
            let str = `<a class="jss23775 selectPricePolicy" data-id="${data.id}" data-value="${data.title}">
                         ${data.title}
                       </a>`;

            CustomerApp.page.elements.listPricePolicy.prepend(str);
            CustomerApp.IziToast.showSuccessAlert("Thêm mới chính sách giá thành công")
            CustomerApp.page.elements.modalCreatePricePolicy.modal("hide");
            CustomerApp.page.elements.frmCreatePricePolicy[0].reset();
            CustomerApp.page.commands.selectPricePolicy();
        })
            .fail((jqXHR) => {
                console.log(jqXHR)
                let errors = jqXHR.responseJSON.errors;

                if (errors.title) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.titleError, errors.title)
                }
                if (errors.pricingPolicyCode) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.pricingPolicyCodeError, errors.pricingPolicyCode)
                }
                if (errors.pricingPolicyType) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.pricingPolicyTypeError, errors.pricingPolicyType)
                }
            })
    }

<<<<<<< HEAD
    function createCusGrp() {
        createCusGroupParam.id = undefined;
        let title = $('#titleGroup').val().trim();
        createCusGroupParam.title = title.length > 0 ? title : undefined;

        let cusGrpCode = $('#cusGrpCode').val().trim();
        createCusGroupParam.cusGrpCode = cusGrpCode.length > 0 ? cusGrpCode : undefined;

        let note = $('#description').val().trim();
        createCusGroupParam.note = note.length > 0 ? note : undefined;
        createCusGroupParam.defaultPricingPolicyId = $('#pricingType').data("id");
        createCusGroupParam.defaultDiscountRate = $('#discount').val();
        createCusGroupParam.defaultPaymentMethodId = $('#paymentType').data("id");
=======
    //create customer group
    CustomerApp.page.commands.createCusGrp = () => {
        createCusGroupParam.title = CustomerApp.page.elements.titleGroupCre.val().trim();
        createCusGroupParam.description = CustomerApp.page.elements.description.val().trim();

        let cusGrpCode = CustomerApp.page.elements.cusGrpCode.val().trim();

        cusGrpCode ? createCusGroupParam.cusGrpCode = cusGrpCode : undefined;

        CustomerApp.page.elements.discount.val().trim() === ''
            ? createCusGroupParam.discount = 0
            : createCusGroupParam.discount = CustomerApp.page.elements.discount.val().trim();
>>>>>>> 1839f2e0f3941be51a38ccbca6f4385ee3045bee

        console.log(createCusGroupParam)

        $.ajax({
            "headers": {
                "accept": "application/json",
                "content-type": "application/json"
            },
            "type": "POST",
            "url": origin + "/api/customer_groups",
            "data": JSON.stringify(createCusGroupParam)
        })
            .done((data) => {
                console.log(data)
                CustomerGroup_App.IziToast.showSuccessAlert('Thêm mới nhóm khách hàng thành công  !!!')
            })
            .fail((jqXHR) => {
                console.log(jqXHR)
                let errors = jqXHR.responseJSON.errors;

                if (errors.title) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.titleGroupCreError, errors.title)
                }
                if (errors.cusGrpCode) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.cusGrpCodeError, errors.cusGrpCode)
                }
                if (errors.description) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.descriptionError, errors.description)
                }
                if (errors.discount) {
                    CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.discountError, errors.discount)
                }
            })
    }

    CustomerApp.page.elements.btnCloseCreatePricePolicyModal.click(() => {
        CustomerApp.page.elements.frmCreatePricePolicy.validate().resetForm();
        CustomerApp.page.elements.frmCreatePricePolicy[0].reset();
        CustomerApp.page.elements.error.removeClass('show').addClass('hidden')
    })

    CustomerApp.page.elements.btnCreatePricePolicy.on("click", () => {
        CustomerApp.page.elements.frmCreatePricePolicy.trigger("submit");
    })

    CustomerApp.page.elements.btnCreateCustomerGroup.on("click", () => {
        CustomerApp.page.elements.frmCreateCusGrp.trigger("submit");
    })

    CustomerApp.page.elements.frmCreatePricePolicy.validate({
        rules: {
            titlePricePolicyCre: {
                required: true,
                maxlength: 50,
            },
            pricingPolicyCodeCre: {
                required: true,
                maxlength: 50,
            },
            policyStyle: {
                required: true,
            }
        },
        messages: {
            titlePricePolicyCre: {
                required: "Tên chính sách giá không được để trống",
                maxlength: "Tên chính sách giá không được vượt quá 50 ký tự"
            },
            pricingPolicyCodeCre: {
                required: "Mã chính sách giá không được để trống",
                maxlength: "Mã chính sách giá không được vượt quá 50 ký tự"
            },
            policyStyle: {
                required: "Vui lòng chọn loại chính sách giá"
            }
        },
        showErrors: (error) => {
            if (error.titlePricePolicyCre) {
                CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.titleError, error.titlePricePolicyCre);
            }
            if (error.pricingPolicyCodeCre) {
                CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.pricingPolicyCodeError, error.pricingPolicyCodeCre);
            }
            if (error.policyStyle) {
                CustomerApp.page.commands.showErrorValidate(CustomerApp.page.elements.pricingPolicyTypeError, error.policyStyle);
            }
        },
        submitHandler: () => {
            CustomerApp.page.commands.createPricePolicy();
        },
    });

    CustomerApp.page.elements.frmCreateCusGrp.validate({
        rules: {
            titleGroupCre: {
                required: true,
                maxlength: 50,
            },
            cusGrpCode: {
                maxlength: 50,
            },
            description: {
                maxlength: 255,
            },
            discount: {
                digits: true,
            }
        },
        messages: {
            titleGroupCre: {
                required: "Tên nhóm khách hàng không được để trống",
                maxlength: "Tên nhóm khách hàng không quá 50 ký tự"
            },
            cusGrpCode: {
                maxlength: "Mã nhóm không quá 50 ký tự",
            },
            description: {
                maxlength: "Mô tả không quá 255 ký tự",
            },
            discount: {
                digits: "Chỉ được nhập số",
            },
        },
        errorElement: 'label',
        errorPlacement: function (error, element) {
            error.appendTo(element.parent("div").parent("div").next("div"));
        },
        success: (label) => {
            label.removeClass('hidden').addClass('show')
        },
        submitHandler: () => {
            CustomerApp.page.commands.createCusGrp();
        },
        invalidHandler: () => {
            CustomerApp.IziToast.showErrorAlert('Vui lòng nhập đúng thông tin')
        }

    })

    $(() => {
        CustomerApp.page.commands.getAllPricingPolicy();
        CustomerApp.page.commands.getAllPaymentMethod();
    })

    CustomerApp.page.commands.showDefaultPriceDropdown = () => {
        CustomerApp.page.elements.defaultPriceDropdown[0].classList.toggle("show")
    }

    CustomerApp.page.commands.showErrorValidate = (element, error) => {
        element.addClass('show').removeClass('hidden');
        element.text(error);
        CustomerApp.IziToast.showErrorAlert(error);
    }

    CustomerApp.page.commands.searchDefaultPriceDropdown = () => {
        let filter, input, div, a, i;

        input = CustomerApp.page.elements.searchDefaultPriceDropdown;

        filter = input.val().toUpperCase();

        div = document.getElementById("defaultPriceDropdown");

        a = div.getElementsByTagName("a");
        for (i = 0; i < a.length; i++) {
            let txtValue = a[i].textContent || a[i].innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                a[i].style.display = "";
            } else {
                a[i].style.display = "none";
            }
        }
    }
</script>
</html>