<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="sapo-menu-expand sapo-menu-toggle-active" lang="vi-VN">

<head>
    <meta charset="utf-8"/>
    <th:block th:replace="/layout/supplier/header :: header"/>
<!--    <script>-->
<!--        var CKEDITOR_BASEPATH = '/v2/lib/ckeditor/';-->
<!--        var S_LANG = 'vi-VN';-->
<!--        var S_LANG_RES = 'https://sapo.dktcdn.net/sapo-frontend-x/d9ad77d.i18n_vi-VN.json';-->
<!--    </script>-->
<!--    <script src="https://sapo.dktcdn.net/sapo-frontend-x/ab0f3c2.client.bundle.js"></script>-->
<!--    <link rel="stylesheet" href="https://sapo.dktcdn.net/sapo-frontend-x/6386cc5.main.css" />-->
<!--    <script src="https://sapo.dktcdn.net/fe-cdn-production/lib/wootric/wootric-sdk.js"></script>-->
<!--    <script src="https://sapo.dktcdn.net/fe-cdn-production/lib/upload-files/jquery.multifile.js"></script>-->

<!--    <link href="https://sapo.dktcdn.net/fe-cdn-production/lib/driver/driver.min.css?v=20220218" rel="stylesheet" />-->
<!--    <script>-->
<!--        var CKEDITOR_BASEPATH = '/v2/lib/ckeditor/';-->
<!--        var S_LANG = 'vi-VN';-->
<!--        var S_LANG_RES = 'https://sapo.dktcdn.net/sapo-frontend-x/d9ad77d.i18n_vi-VN.json';-->
<!--    </script>-->
<!--    <script src="https://sapo.dktcdn.net/sapo-frontend-x/d852af0.client.bundle.js"></script>-->
    <style>
        #renderGroupLi > li:hover {
            background-color: #007bff;
        }

        .dropdown-menu > li > p:hover {
            background-color: #007bff
        }
    </style>
</head>

<body class="body_dashboard partners suppliers edit">
<div id="container">
    <div class="hidden" context="tenantInfo"
         define="{tenantInfo: new Components.TenantInfo(this,{&quot;countries&quot;:{&quot;countryId&quot;:201}})}">
    </div>
    <div class="header-mobile">
        <a href="javascript:" class="icon-menu visible-xs visible-sm" onclick="showMenu()">
            <svg class="next-icon next-icon--size-20">
                <use xlink:href="#icon-menu" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
            </svg>
        </a>
    </div>
    <th:block th:replace="/layout/supplier/menu :: menu"/>

    <div class="col-right">
        <div class="col-right_content" id="content">
            <div class="ui-title-top-bar">
                <div class="ui-title-top-bar_action w-100 flex">
                    <div class="w-50" style="padding-top:5px">
                    </div>
                    <div class="w-50" style="position:relative">
                        <a href="#" class="btn sapo-btn-default right btn-update-supplier btnUpdateSupplier">Lưu</a>
                        <a th:href="'/admin/suppliers/' + ${supplier.id} + '/histories'"
                           class="btn sapo-btn-blank right mr-3">Huỷ</a>
                    </div>

                    <style>
                        .help-dashboard .help-dropdown .btn-blank {
                            background: #fff url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA39pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplN2MwNTFiZi1lNGJiLTNjNDktOGM3YS00NTZmZTZlNGQ1NmYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RjI5NDdDQ0NGMUY1MTFFODhFOTZCNjZBNjQxRjJFNzUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RjI5NDdDQ0JGMUY1MTFFODhFOTZCNjZBNjQxRjJFNzUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjdkNDRhZTRlLTIzMTMtYTE0ZC1hNWQ4LTA5YTVjYTBmNmM0NCIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjk3N2NmYTliLThmZDctZGU0Mi1hNDFiLWIwOTJiYzRkYWM2MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Po5ReOIAAAIxSURBVHjalJU9aFNRGIbTk+sSh0xiEKciaBF1culiA2IdOlQHaRBKqEurYJYOFn9Ql7iJghQcSqlDAop0yFIoWJcigouKKIROClWnomaQVHw+eAPxcs7J9cDDhXvP997vfH9naPbybC6wEpiASRiFYcjDLmzBJqxCa/HRYtcn4ALCFWjDQ/gGNRiB/XrW9N6+t+euzFV8IkMpzwuwDGNwDVagmwsvO9003IMNqHKKjs9zE16Dg3AclgYI2+oitqT9ZrfGKQo+8WXF9DRs5/5j8YNt2eWl8494RaE4Dx1f+OAwnIRi4Acd2Y/1cuAUt7pi7PP4GLyHj/AavsPNyAlMp84PEqdyc0qer5oa8AuOQAnuw10YD0RpRXYTTnXcDCTvBByVp5/gK1yH33Am4H1XepNODfIi4MUPuANv+t7tgz3wM5Jj0xtN1HntwCZ7fztVrk3F/XFE3OyGE5XPToaKs33PlOBT8CWy1/TyTrOimEH8IpyFc/BuwF7T23UaQocyiJfhA7zMsNf0tpymWzmDwROYz9i0prfpNDan1EyxtRcODFK15pHeqom34I+mW2xdglsZvJ6WXsupeRY0NksRoxvyKOZ1SToL1ky9wdXQPH6uWvYtmy+vIsIF2W8g3EiP3KrKcn3ACUIer8u+6pvnHQ2jz/AWZjIkOUF4RvvNbrz/Jkob24cLmu91tX5Ts6KtziuqjsvKgSWv1gtF+g70Ldv4tO/2fxC4/a/Gbv+/AgwA9q+ezeP4kToAAAAASUVORK5CYII=') no-repeat center center;
                            border: none;
                            font-size: 0;
                            box-shadow: none;
                            margin-left: 0;
                            height: 61px;
                            width: 60px;
                            border: 1px solid #dbdbdb;
                            outline: none;
                            border-radius: 0;
                        }

                        .help-dashboard .help-dropdown .btn-blank:focus {
                            box-shadow: none;
                        }

                        .help-dashboard .help-dropdown .help-popup {
                            top: 60px;
                            box-shadow: #c6c6c6 0px 3px 5px 0px;
                        }

                        .help-dashboard .help-dropdown .help-popup:after {
                            right: 20px;
                        }

                        .sapo-menu-expand .page-heading {
                            z-index: 1001;
                        }

                        .help-dropdown {
                            position: relative;
                            margin-left: 10px;
                            height: 36px;
                        }


                        .help-dropdown a {
                            color: #686868;
                            display: flex;
                            height: 100%;
                            border: none;
                            flex-direction: row;
                            justify-content: center;
                            align-items: center;
                            cursor: pointer;
                            border: 1px solid #c4cdd5;
                            float: right;
                            width: auto;
                        }

                        .help-dropdown div:hover {
                            background-color: #e7f2ff;
                        }


                        .help-dropdown .btn-blank:focus {
                            box-shadow: none;
                            border: 1px solid #c4cdd5;
                        }

                        .help-dropdown .help-popup {
                            position: absolute;
                            right: 0;
                            z-index: 9999999;
                            top: 45px;
                            box-shadow: #c6c6c6 0 0 10px 5px;
                            display: none;
                            -webkit-transition: ease 0.5s;
                            /* Safari */
                            transition: ease 0.5s;
                        }

                        .help-dropdown .help-popup.shown {
                            display: block;
                            height: 560px;
                            margin-top: 15px;
                        }

                        .help-dropdown .help-popup:after {
                            content: "";
                            display: block;
                            width: 0px;
                            height: 0px;
                            border-left: 10px solid transparent;
                            border-right: 10px solid transparent;
                            border-bottom: 10px solid #f3f6f8;
                            top: -9px;
                            position: absolute;
                            right: 25px;
                        }
                    </style>
                    <div class="header-fr help-dropdown">
                        <a class="btn sapo-btn-blank btn-help" onclick="showHelpPopup()"><img
                                src="/v2/images/dashboard/icons8-help-20.png"
                                style="padding-right: 5px;"/><span>Trợ giúp</span></a>
                        <div class="help-popup">
                            <iframe id="iframe-help" src=""
                                    style="width: 400px; height: 560px;border:none"></iframe>
                            <input type="hidden" id="iframe-help-src"
                                   value="https://support.sapo.vn?ver=2&amp;view=pos&amp;url=http://anges.mysapogo.com/admin/suppliers/206718863/edit"/>
                        </div>
                    </div>

                    <script type="text/javascript">
                        function showHelpPopup() {
                            $("#iframe-help").attr("src", $("#iframe-help-src").val());
                            $(".help-popup").toggleClass("shown");
                            $(".favourite").css({"z-index": "0"});
                        }

                        $(function () {
                            $('body').on('click', function (e) {
                                if (!$('.help-dropdown .btn-help *').is(e.target) && !$('.help-dropdown .btn-help').is(e.target) && $('.help-popup').hasClass("shown")) {
                                    $("#iframe-help").attr("src", "");
                                    $(".help-popup").removeClass("shown");
                                }
                            });
                        });
                    </script>

                </div>
            </div>
            <header class="ui-title-bar-container" style="margin-top: 55px;">
                <div class="ui-title-bar">
                    <div class="ui-title-bar__navigation">
                        <div class="ui-breadcrumbs">
                            <a href="/admin/suppliers">
                                <svg class="next-icon next-icon--size-20 next-icon--no-nudge">
                                    <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                         xlink:href="#chevron-left-thinner"></use>
                                </svg>
                                <span class="ui-breadcrumb__item">Danh sách nhà cung cấp</span>
                            </a>
                        </div>
                    </div>
                    <div class="ui-title-bar__main-group">
                        <div class="ui-title-bar__heading-group">
                            <h1 class="ui-title-bar__title">Cập nhật nhà cung cấp <span th:value="${supplier.id}"
                                                                                        th:text="${supplier.fullName}"></span>
                            </h1>
                        </div>
                    </div>
                </div>
            </header>
            <form id="formUpdateSupplier">
                <div class="customer-container container" id="form-create-supplier" context="editSupplier">
                    <div class="customer-create--left">
                        <div class="page-info">
                            <div class="page-info-body">
                                <div class="col-12 field p-0">
                                    <div class="label mb-2 label-required">Tên nhà cung cấp</div>
                                    <input id="fullName" name="fullName" class="sapo-textbox w100" data-toggle="tooltip"
                                           placeholder="Nhập tên nhà cung cấp"
                                           th:field="${supplier.fullName}"
                                    >
                                </div>
                                <div class="col-6 field pl-0">
                                    <div class="label mb-2">Mã nhà cung cấp</div>
                                    <input required id="supplierCode" class="sapo-textbox w100" data-toggle="tooltip"
                                           th:field="${supplier.supplierCode}">
                                </div>
                                <div class="col-6 field pr-0">
                                    <div class="label mb-2">Nhóm nhà cung cấp</div>
                                    <div>
                                        <div class="btn-group">
                                            <button id="changeValueSup" class="btn secondary dropdown-toggle"
                                                    style="width: 300px; height: 34px; text-align: left"
                                                    data-bs-toggle="dropdown"
                                                    data-bs-auto-close="outside" aria-expanded="false"
                                                    th:value="${supplier.group} ? ${supplier.group.id} : null"
                                                    th:text="${supplier.group} ? ${supplier.group.title} : ${'Chọn nhóm nhà cung cấp'}">

                                                <!--                                            th:value="${supplier.group.id}" th:text="${supplier.group} ? ${supplier.group.title} : ${'-&#45;&#45;'}-->

                                                <!--                                            <th:block th:each="group : ${supplierGroup}">-->
                                                <!--                                                <th:block th:if="${group.id} == ${supplier.supplierGroup.id}">-->
                                                <!--                                                    <th:block   th:text="${group.title}"></th:block>-->
                                                <!--                                                </th:block>-->
                                                <!--                                            </th:block>-->

                                                <!--                                            th:field="${supplier.supplierGroup.title} ? ${supplier.supplierGroup.title} : ${'-&#45;&#45;'} "-->
                                                <!--                                            Khác-->
                                            </button>

                                            <ul class="dropdown-menu"
                                                aria-labelledby="dropdownMenuClickableInside" style="width: 300px">
                                                <li><input id="inputKey" type="text" placeholder="Tìm kiếm"
                                                           oninput="searchGroup()"
                                                           style="width: 296px; height:35px;font-size: 13px;">
                                                </li>

                                                <li>
                                                    <i class="fa-solid fa-plus"
                                                       style="float: left; margin: 4px 2px 0 0; padding-top: 8px"></i>
                                                    <p id="showGroupSupplier"
                                                       style="height: 30px; width: 300px; font-size: 13px; padding-top: 8px">
                                                        Thêm mới nhóm nhà cung cấp</p>
                                                </li>
                                                <li id="errorGroup" class="hidden">hihi</li>
                                                <li id="renderGroupLi"></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <th:bock th:replace="/admin/suppliers/modals/groups/create_group_supplier :: create_group_supplier"/>
                                <div class="col-6 field pl-0">
                                    <div class="label mb-2">Số điện thoại</div>
                                    <input id="phoneUp" class="sapo-textbox w100" data-toggle="tooltip"
                                           th:value="${supplier.phone}">
                                    <div id="warning-dubble-phone" style="display:none;font-size:13px;color:#f6574d">
                                    </div>
                                </div>
                                <div class="col-6 field pr-0">
                                    <div class="label mb-2">Email</div>
                                    <input id="emailUp" class="sapo-textbox w100" data-toggle="tooltip"
                                           th:value="${supplier.email}">
                                </div>
                            </div>
                        </div>

                        <div class="page-info">
                            <div class="page-info-title">
                                Thông tin bổ sung
                            </div>
                            <div class="page-info-body">
                                <div class="col-6 field pl-0">
                                    <div class="label mb-2">Số fax</div>
                                    <input id="faxUp" class="sapo-textbox w100" data-toggle="tooltip"
                                           th:value="${supplier.fax}">
                                </div>
                                <div class="col-6 field pr-0">
                                    <div class="label mb-2">Mã số thuế</div>
                                    <input id="taxCodeUp" class="sapo-textbox w100" data-toggle="tooltip" th:value="${supplier.taxCode}"

                                    >

                                </div>
                                <div class="col-6 field pl-0">
                                    <div class="label mb-2">Website</div>
                                    <input id="websiteUp" class="sapo-textbox w100" data-toggle="tooltip"
                                           th:value="${supplier.website}">
                                </div>
                                <div class="col-6 field pr-0">
                                    <div class="label mb-2">Trạng thái nhà cung cấp</div>
                                    <select id="statusUp" class="w100 input-dropdown sapo-btn-blank select-padding"
                                            th:field="${supplier.status}">
                                        <option th:seleted="${supplier.status == 'AVAILABLE'}" value="AVAILABLE">Đang giao
                                            dịch
                                        </option>
                                        <option th:seleted="${supplier.status == 'UNAVAILABLE'}" value="UNAVAILABLE">Ngừng
                                            giao dịch
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="customer-create--right">
                        <div class="page-info">
                            <div class="page-info-title">
                                Thông tin khác
                            </div>
                            <div class="page-info-body">
                                <div class="col-12 field p-0">
                                    <div class="label mb-2">Nhân viên phụ trách</div>
                                    <div class="select__wrapper " id="search-account-wrap">
                                        <a class="sapo-select select--a select-suggest" id="search-account"
                                           href="javascript:">
                                            <select style="width: 282px; height: 25px;border: gray;" id="fulNameEmployeeUp">
                                                <option th:value="${supplier.employee.id}"
                                                        th:text="${supplier.employee} ? ${supplier.employee.fullName} : ${'Chọn nhân viên phụ trách '}"></option>

                                                <!--                                            <th:block th:each="employee : ${employee}">-->
                                                <!--                                                <th:block th:if="${employee.id}== ${supplier.employee.id}">-->
                                                <!--                                                    <option th:text="${employee.fullName}"></option>-->
                                                <!--                                                </th:block>-->
                                                <!--                                            </th:block>-->
                                            </select>
                                        </a>
                                        <svg class="next-icon next-icon--size-16">
                                            <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                 xlink:href="#select-chevron"></use>
                                        </svg>
                                        <div class="filter-body--suggest">
                                        </div>
                                    </div>
                                </div>
                                <div class="page-info-item col-12 no-padding mb-4">
                                    <div class="page-info-item-title">
                                        MÔ TẢ
                                        <i class="fa fa-info" data-toggle="tooltip" data-placement="top"
                                           title="Mô tả nhà cung cấp của bạn để phục vụ cho việc chăm sóc nhà cung cấp tốt hơn"></i>
                                    </div>
                                    <textarea id="descriptionUp" bind="description" class="sapo-textbox"
                                              th:field="${supplier.description}" style="height:54px"></textarea>
                                </div>
                                <div class="page-info-item col-12 p-0">
                                    <div class="page-info-item-title">
                                        TAG
                                        <i class="fa fa-info" data-toggle="tooltip" data-placement="top"
                                           title="Chọn hoặc thêm thẻ sẽ cho phép bạn tìm kiếm và lọc nhà cung cấp ở trang danh sách dễ dàng hơn"></i>
                                    </div>
                                    <input class="sapo-textbox tags" bind="tagso" value="fastfuasj"/>
                                </div>
                            </div>
                        </div>
                        <div class="page-info">
                            <div class="page-info-title">
                                Cài đặt nâng cao
                                <i class="fa fa-info" data-toggle="tooltip" data-placement="top"
                                   title="Thiết lập các thông số tự động dùng trong các giao dịch"></i>

                            </div>
                            <div class="page-info-body">

                                <div id="config-customer" class="w-100">
                                    <div class="col-12 field p-0">
                                        <div class="label mb-2">Giá mặc định</div>
                                        <div class="select__wrapper " id="search-price-list-wrap">
                                            <a class="sapo-select select--a select-suggest" id="search-price-list"
                                               href="javascript:">
                                                Chọn giá mặc định </a>
                                            <svg class="next-icon next-icon--size-16">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                     xlink:href="#select-chevron"></use>
                                            </svg>
                                            <div class="filter-body--suggest">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 field p-0">
                                        <div class="label mb-2">Hình thức thanh toán</div>

                                        <select style="width: 295px; height: 35px; border:1px solid #95a7b7; border-radius: 3px" id="paymentMethod">
                                            <option th:value="${supplier.paymentMethod} ? ${supplier.paymentMethod.id} : null"
                                                    th:text="${supplier.paymentMethod} ? ${supplier.paymentMethod.title} : ${'Chọn hình thức'}"></option>
                                        </select>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="ui-title-bottom-bar">
                        <a href="javascript:"
                           class="btn sapo-btn-default right btn-update-supplier btnUpdateSupplier">Lưu</a>
                        <a th:href="'/admin/suppliers/' + ${supplier.id} + '/histories'"
                           class="btn sapo-btn-blank right mr-3">Huỷ</a>
                    </div>
                    <input type="hidden" id="supplierId" th:value="${supplier.id}">
                    <script class="modal_source" define="{createSupplierGroupModal: new Components.Modal(this)}"
                            type="text/html">
                        <div class="modal-dialog modal-dialog-new form-create-customer-group">
                            <div class="modal-content">
                                <div class="modal-header">
                    <span class="ui-dialog-title">
                        Thêm mới nhóm nhà cung cấp
                    </span>
                                    <span class="modal-close-wrapper">
                        <svg class="ui-icon-x ui-icon-x-20"> <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                                  xlink:href="#cancel-small-minor"></use> </svg>
                    </span>

                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="left field w-100">
                                                <div class="label mb-2 label-required">Tên nhóm</div>
                                                <input class="sapo-textbox w100 pull-left" bind="supplierGroup.name"
                                                       bind-event-input="checkValidateDataSupplierGroup(this)"
                                                       data-toggle="tooltip" placeholder="Nhập tên nhóm nhà cung cấp">
                                            </div>
                                            <div class="left field w-100 mb-2">
                                                <div class="label mb-2">Mã nhóm</div>
                                                <input class="sapo-textbox w100 pull-left" bind="supplierGroup.code"
                                                       bind-event-input="checkValidateDataSupplierGroup(this)"
                                                       data-toggle="tooltip" placeholder="Nhập mã nhóm nhà cung cấp">
                                            </div>
                                        </div>
                                        <div class="col-6 field mb-2">
                                            <div class="label mb-2">Ghi chú</div>
                                            <textarea bind="supplierGroup.note" class="sapo-textbox"
                                                      style="height:113px"></textarea>
                                        </div>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <div class="action-btn clearfix">
                                        <button class="btn btn-default pull-right margin-left-5 sapo-btn-default"
                                                href="javascript:void(0)" bind-event-click="createSupplierGroup(this)">Thêm
                                        </button>
                                        <button class="close-modal btn btn-blank pull-right" type="button">
                                            Thoát
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </script>
                    <script class="modal_source" define="{createPriceListModal: new Components.Modal(this)}"
                            type="text/html">
                        <div class="modal-dialog modal-dialog-new form-create-price-list">
                            <div class="modal-content">
                                <div class="modal-header">
                    <span class="ui-dialog-title">
                        Thêm chính sách giá
                    </span>
                                    <span class="modal-close-wrapper">
                        <svg class="ui-icon-x ui-icon-x-20"> <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                                  xlink:href="#cancel-small-minor"></use> </svg>
                    </span>

                                </div>
                                <div class="modal-body newscroll" id="body-price-list">
                                    <div class="row">
                                        <div class="col-12 col-md-6 field">
                                            <div class="label mb-2 label-required">Tên chính sách giá</div>
                                            <input class="sapo-textbox w100 pull-left" bind="priceList.name"
                                                   bind-event-input="checkValidateDataPriceList(this)" data-toggle="tooltip"
                                                   placeholder="Ví dụ: Giá bán lẻ">
                                        </div>
                                        <div class="col-12 col-md-6 field">
                                            <div class="label mb-2 label-required">Mã chính sách giá</div>
                                            <input class="sapo-textbox w100 pull-left" bind="priceList.code"
                                                   bind-event-input="checkValidateDataPriceList(this)" data-toggle="tooltip"
                                                   placeholder="Ví dụ: BANLE">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12 field m-0">
                                            <div class="label mb-2">Áp dụng cho:</div>
                                            <div class="group-radiobox flex">
                                                <label class="flex cursor-pointer" style="width: 150px;">
                                    <span class="sapo-radiobox mr-2">
                                        <input bind="priceList.isCost" autocomplete="off" class="sapo-radiobox__input"
                                               type="radio" name="priceList.isCost" value="False" checked>
                                        <span class="sapo-radiobox__icon"></span>
                                    </span>
                                                    Bán hàng
                                                </label>
                                                <label class="flex cursor-pointer" style="width: auto;">
                                    <span class="sapo-radiobox mr-2">
                                        <input bind="priceList.isCost" autocomplete="off" class="sapo-radiobox__input"
                                               type="radio" name="priceList.isCost" value="True">
                                        <span class="sapo-radiobox__icon"></span>
                                    </span>
                                                    Nhập hàng
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <div class="action-btn clearfix">
                                        <button class="btn btn-default pull-right margin-left-5 sapo-btn-default"
                                                href="javascript:void(0)" bind-event-click="createPriceList(this)">Thêm
                                        </button>
                                        <button class="close-modal btn btn-blank pull-right" type="button">
                                            Thoát
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </script>
                </div>
            </form>

        </div>
        <div class="popup-box">
            <iframe scrolling="no" src="about:blank" name="myIframe" id="popupPrint"
                    style="border:0;position:absolute;width:0px;height:0px;left:0px;top:0px;"></iframe>
        </div>
    </div>
</div>
<div class="section-footer">

</div>
<div class='container-fluid-md notifications'>
    <div class='ajax-notification'><span class='ajax-notification-message'></span></div>
</div>
<div class="modal fade" id="sapo-modal-container" data-width="" tabindex="-1" role="dialog" data-backdrop="false">
</div>
<div class="modal-backdrop fade in" id="sapo-modal-backdrop"></div>


<style>
    #surveys {
        position: fixed;
        bottom: 0;
        width: calc(100% - 23rem);
        right: 0;
        z-index: 999999
    }

    .sapo-menu-collapse #surveys {
        width: calc(100% - 5.6rem) !important;
    }
</style>
<div id="surveys"></div>

<script>
    Page();
    hj('trigger', 'split_test_b');
</script>
<!-- End Freshchat -->

<div context="notificationVNPay"
     define="{notificationVNPay: new Components.NotificationVNPay(this, {accountId:941587 })}">
    <div class="popup-notification">
        <a href="javascript:" bind-event-click="closeNoti()" class="close">
            <svg>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#cancel-small-minor"></use>
            </svg>
        </a>
        <a href="" target="_blank" class="link-order">
            <img class="left" src="/v2/images/ico-sapo.png"/>

        </a>
        <a href="" target="_blank" class="link-order">
            <div class="title left">Thanh toán đơn hàng</div>
            <div class="desc left"></div>
        </a>
    </div>
</div>
</body>
<th:block th:replace="/layout/script :: script"/>
<script src="/assets/admin/js/suppliers/supplier_app.js"></script>
<script src="/assets/admin/js/suppliers/jquery/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/izitoast@1/dist/js/iziToast.min.js" type="text/javascript"
        crossorigin></script>
<script>

    let supplierGroups = [];
    const page = {
        urls: {},
        elements: {},
        commands: {},
        dialogs: {
            elements: {},
            commands: {}
        }
    }

    class createSupGroupParam {
        constructor( title, supGroupCode, description) {
            this.title = title;
            this.supGroupCode = supGroupCode;
            this.description = description;
        }
    }

    class UpdateSupplierParam {
        constructor(id, supplierCode, fullName, email, phone, description, paymentMethodId, groupId, employeeId, status, taxCode, fax,website) {
            this.id = id;
            this.supplierCode = supplierCode;
            this.fullName = fullName;
            this.email = email;
            this.phone = phone;
            this.desription = description;
            this.paymentMethodId = paymentMethodId;
            this.groupId = groupId;
            this.employeeId = employeeId;
            this.status = status;
            this.taxCode = taxCode;
            this.fax = fax;
            this.website = website
        }
    }

    page.elements.renderGroupLi = $("#renderGroupLi");

    page.elements.formUpdateSupplier = $("#formUpdateSupplier");
    page.elements.btnUpdateSupplier = $(".btnUpdateSupplier");
    page.elements.supplierId = $("#supplierId");
    page.elements.supplierCode = $("#supplierCode");
    page.elements.fullName = $("#fullName");
    page.elements.emailUp = $("#emailUp");
    page.elements.phoneUp = $("#phoneUp");
    page.elements.statusUp = $("#statusUp");
    page.elements.descriptionUp = $("#descriptionUp");
    page.elements.changeValueSup = $("#changeValueSup");
    page.elements.fulNameEmployeeUp = $("#fulNameEmployeeUp");
    page.elements.paymentMethod = $("#paymentMethod");
    page.elements.taxCodeUp = $("#taxCodeUp");
    page.elements.faxUp = $("#faxUp");
    page.elements.websiteUp = $("#websiteUp");

    page.elements.showGroupSupplier = $("#showGroupSupplier");
    page.dialogs.elements.formCreateGroup = $("#formCreateGroup");
    page.dialogs.elements.modalCreateGroupSupplier = $("#modalCreateGroupSupplier");
    page.dialogs.elements.btnCreateGroupSupplier = $("#btnCreateGroupSupplier");
    page.dialogs.elements.groupCreateId = $("#groupCreateId");
    page.dialogs.elements.groupCreateTitleSup = $("#groupCreateTitleSup");
    page.dialogs.elements.groupCreateCodeSup = $("#groupCreateCodeSup");
    page.dialogs.elements.groupCreateDescriptionSup = $("#groupCreateDescriptionSup");

    function getAllEmployeeSelect() {
        return $.ajax({
            "headers": {
                "accept": "application/json",
                "content-type": "application/json"
            },
            "type": "GET",
            "url": origin + "/api/employees"
        })
            .done((data) => {
                console.log("nhan viên", data)

                $.each(data, (i, item) => {
                    let str = `<option value="${item.id}">${item.fullName}</option>`;
                    page.elements.fulNameEmployeeUp.append(str);
                });
            })
    }

    function getAllPaymentMethodSelect() {
        return $.ajax({
            "headers": {
                "accept": "application/json",
                "content-type": "application/json"
            },
            "type": "GET",
            "url": origin + "/api/admin/payment_methods"
        })
            .done((data) => {
                console.log("method select", data)
                $.each(data, (i, item) => {
                    let str = `<option value="${item.id}"> ${item.title}</option>`;
                    page.elements.paymentMethod.append(str);
                })
            })
    }

    page.elements.btnUpdateSupplier.on('click', () => {
        let idSupp = page.elements.supplierId.val();
        let supplierCode = page.elements.supplierCode.val();
        let fullName = page.elements.fullName.val();
        let email = page.elements.emailUp.val();
        let phone = page.elements.phoneUp.val();
        let status = page.elements.statusUp.val();
        let description = page.elements.descriptionUp.val();
        let employeeId = page.elements.fulNameEmployeeUp.val();
        let paymentMethodId = page.elements.paymentMethod.val();
        let groupId = page.elements.changeValueSup.val();
        let taxCode =  page.elements.taxCodeUp.val();
        let fax = page.elements.faxUp.val();
        let website = page.elements.websiteUp.val();


        let newUpdateSupplierParam = {
            id: idSupp,
            supplierCode: supplierCode.length > 0 ? supplierCode : undefined,
            fullName: fullName.length > 0 ? fullName : undefined,
            email: email.length > 0 ? email : undefined,
            phone: phone.length > 0 ? phone : undefined,
            status: status,
            description: description.length > 0 ? description : undefined ,
            employeeId: employeeId,
            paymentMethodId: paymentMethodId.length > 0 ? paymentMethodId : undefined,
            groupId: groupId,
            taxCode: taxCode.length > 0 ? taxCode : undefined,
            fax: fax.length > 0 ? fax : undefined,
            website : website.length > 0 ? website : undefined,
        }
        console.log("newUpdateSupplierParam : ", newUpdateSupplierParam)

        $.ajax({
            "headers": {
                "accept": "application/json",
                "content-type": "application/json"
            },
            "type": "PATCH",
            "url": origin + "/api/suppliers/" + idSupp,
            "data": JSON.stringify(newUpdateSupplierParam)
        })
            .done((data) => {
                SupplierApp.IziToast.showSuccessAlert("Sửa thông tin nhà cung cấp thành công!");
                setTimeout(() => {
                }, 1500);
                window.location.href = `/admin/suppliers/${data.id}/histories`;
            })
            .fail((jqXHR) => {
                // console.log(jqXHR);
                SupplierApp.IziToast.showErrorAlert("Sửa thông tin nhà cung cấp thất bại")
            })
        // page.elements.formUpdateSupplier.trigger('submit');
    })

    // function doUpdateSupplier() {
    //     let idSupp = page.elements.supplierId.val();
    //     let supplierCode = page.elements.supplierCode.val();
    //     let fullName = page.elements.fullName.val();
    //     let email = page.elements.emailUp.val();
    //     let phone = page.elements.phoneUp.val();
    //     let status = page.elements.statusUp.val();
    //     let description = page.elements.descriptionUp.val();
    //     let employeeId = page.elements.fulNameEmployeeUp.val();
    //     let paymentMethodId = page.elements.paymentMethod.val();
    //     let groupId = page.elements.changeValueSup.val();
    //     let taxCode =  page.elements.taxCodeUp.val();
    //     let fax = page.elements.faxUp.val();
    //     let website = page.elements.websiteUp.val();
    //
    //
    //     let newUpdateSupplierParam = {
    //         id: idSupp,
    //         supplierCode: supplierCode.length > 0 ? supplierCode : null,
    //         fullName: fullName.length > 0 ? fullName : null,
    //         email: email.length > 0 ? email : null,
    //         phone: phone.length > 0 ? phone : null,
    //         status: status,
    //         description: description.length > 0 ? description : null ,
    //         employeeId: employeeId,
    //         paymentMethodId: paymentMethodId.length > 0 ? paymentMethodId : null,
    //         groupId: groupId,
    //         taxCode: taxCode.length > 0 ? taxCode : null,
    //         fax: fax.length > 0 ? fax : null,
    //         website : website.length > 0 ? website : null,
    //     }
    //     console.log("newUpdateSupplierParam : ", newUpdateSupplierParam)
    //
    //     $.ajax({
    //         "headers": {
    //             "accept": "application/json",
    //             "content-type": "application/json"
    //         },
    //         "type": "PATCH",
    //         "url": origin + "/api/suppliers/" + idSupp,
    //         "data": JSON.stringify(newUpdateSupplierParam)
    //     })
    //         .done((data) => {
    //             console.log("data", data.id);
    //             // let trSupplier = $("#tr_" + data.id);
    //             // let tr = SupplierApp.renderRowSupplier(data);
    //             // trSupplier.replaceWith(tr);
    //             SupplierApp.IziToast.showSuccessAlert("Sửa thông tin nhà cung cấp thành công!");
    //             setTimeout(() => {
    //             }, 1500)
    //             window.location.href = `/admin/suppliers/${data.id}/histories`;
    //         })
    //         .fail((jqXHR) => {
    //             // console.log(jqXHR);
    //             SupplierApp.IziToast.showErrorAlert("Sửa thông tin nhà cung cấp thất bại")
    //         })
    // }

    page.elements.showGroupSupplier.on('click', () => {
        page.dialogs.elements.modalCreateGroupSupplier.modal('show');
        page.dialogs.elements.groupCreateId.val("");
        page.dialogs.elements.groupCreateTitleSup.val("");
        page.dialogs.elements.groupCreateCodeSup.val("");
        page.dialogs.elements.groupCreateDescriptionSup.val("");
        // $("#modal-alert-danger").hide();
        // $("#groupTitleSup-error").hide();
    })

    page.dialogs.elements.btnCreateGroupSupplier.on('click', () => {
        // console.log("vao ham do create group : ")
        // let supGroupCode = page.dialogs.elements.groupCreateCodeSup.val();
        // let supGroupTitle = page.dialogs.elements.groupCreateTitleSup.val();
        // let description = page.dialogs.elements.groupCreateDescriptionSup.val();
        // let newGroupSup =
        //     {
        //         title: supGroupTitle.length > 0 ? supGroupTitle : undefined,
        //         supplierCode: supGroupCode.length > 0 ? supGroupCode : undefined,
        //         description: description.length > 0 ? description : undefined
        //     }
        //
        // console.log("trc ajax", newGroupSup)
        // $.ajax({
        //     "headers": {
        //         "accept": "application/json",
        //         "content-type": "application/json"
        //     },
        //     "type": "POST",
        //     "url": origin + "/api/supplier_groups/create",
        //     "data": JSON.stringify(newGroupSup)
        // })
        //     .done((data) => {
        //         console.log("data: ",data)
        //         SupplierApp.IziToast.showSuccessAlert("Thêm nhóm nhà cung cấp thành công!");
        //         setTimeout(() => {
        //         }, 1500);
        //         page.dialogs.elements.modalCreateGroupSupplier.modal('hide');
        //         location.reload();
        //     })
        //     .fail((jqXHR) => {
        //         SupplierApp.IziToast.showErrorAlert("Nhóm nhà cung cấp đã tồn tại!");
        //         setTimeout(() => {
        //         }, 1500);
        //     })
        $("#formCreateGroup").trigger("submit");
    })


    function doCreateGroupSupplierr(){
        let title =  $("#groupCreateTitleSup").val();
        let supGroupCode = $("#groupCreateCodeSup").val();
        let description = $("#groupCreateDescriptionSup").val();
        let newGroupSup ={
            title: title.length>0 ? title : undefined,
            supGroupCode: supGroupCode.length > 0 ? supGroupCode : undefined,
            description: description.length > 0 ?description:undefined
        }

        $.ajax({
            "headers": {
                "accept": "application/json",
                "content-type": "application/json"
            },
            "type": "POST",
            "url": origin + "/api/supplier_groups/create",
            "data": JSON.stringify(newGroupSup)
        })
            .done((data) => {
                console.log("data: ",data)
                SupplierApp.IziToast.showSuccessAlert("Thêm nhóm nhà cung cấp thành công!");
                setTimeout(() => {
                }, 1500);
                page.dialogs.elements.modalCreateGroupSupplier.modal('hide');
                location.reload();
            })
    }
    $("#formCreateGroup").validate({
        rules: {
            groupCreateTitleSup: {
                required: true,
            },
        },
        messages: {
            groupCreateTitleSup: {
                required: "Tên nhóm nhà cung cấp không được để trống",
            },
        },
        submitHandler: () => {
            doCreateGroupSupplierr();
        }
    })



    // function doCreateGroupSupplier(){
    //     console.log("vao ham do create group : ")
    //     let supGroupCode = page.dialogs.elements.groupCreateCodeSup.val();
    //     let supGroupTitle = page.dialogs.elements.groupCreateTitleSup.val();
    //     let description = page.dialogs.elements.groupCreateDescriptionSup.val();
    //     let newGroupSup =
    //         {
    //             title: supGroupTitle.length > 0 ? supGroupTitle : null,
    //             supplierCode: supGroupCode.length > 0 ? supGroupCode : null,
    //             description: description.length > 0 ? description : null
    //         }
    //
    //     console.log("trc ajax", newGroupSup)
    //     $.ajax({
    //         "headers": {
    //             "accept": "application/json",
    //             "content-type": "application/json"
    //         },
    //         "type": "POST",
    //         "url": origin + "/api/supplier_groups/create",
    //         "data": JSON.stringify(newGroupSup)
    //     })
    //         .done((data) => {
    //             console.log("data: ",data)
    //             SupplierApp.IziToast.showSuccessAlert("Thêm nhóm nhà cung cấp thành công!");
    //             setTimeout(() => {
    //             }, 1500);
    //             page.dialogs.elements.modalCreateGroupSupplier.modal('hide');
    //             location.reload();
    //         })
    //         .fail((jqXHR) => {
    //             SupplierApp.IziToast.showErrorAlert("Nhóm nhà cung cấp đã tồn tại!");
    //             setTimeout(() => {
    //             }, 1500);
    //         })
    // }

    function getAllGroup() {
        $.ajax({
            "headers": {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: origin + "/api/supplier_groups",
        })
            .done((data) => {
                supplierGroups = data;
                $.each(data, function (index, value) {
                    page.elements.renderGroupLi.append(
                        `<li onclick="handleChangeGroupSupp(${value.id})">
                        <p  class="w-20 border-0 " id="${value.id}" style="padding:7px; font-size: 12px;font-weight:450; width: 300px;border: unset;" value="${value.id}">
                        ${value.title}</p>
                        </li>`
                    )
                });
            })
    }

    function handleChangeGroupSupp(supplierGroupId) {
        let supplierGroup = supplierGroups.find(supplierGroup => supplierGroup.id === supplierGroupId);
        page.elements.changeValueSup.attr("data-id", supplierGroup.id);

        page.elements.changeValueSup.val(supplierGroup.id);
        page.elements.changeValueSup.text(supplierGroup.title);

        var dropdown = new bootstrap.Dropdown(document.querySelector($("#changeValueSup")));
        dropdown.hide();
    }

    page.elements.changeValueSup.on('click', () => {
        var dropdown = new bootstrap.Dropdown(document.querySelector($("#changeValueSup")));
        dropdown.show();
    })

    function searchGroup() {

        let valueSearchInput = document.getElementById("inputKey").value
        console.log("valueSearchInput: ", valueSearchInput)
        console.log("supplierGroups :", supplierGroups)

        let groupSearch = supplierGroups.filter(group => {
            return group.title.toUpperCase().includes(valueSearchInput.toUpperCase());
        })
        console.log("nhom search", groupSearch)

        page.elements.renderGroupLi.empty();
        $.each(groupSearch, (i, item) => {
            page.elements.renderGroupLi.prepend(
                `<li onclick="handleChangeGroupSupp(${item.id})">
                    <p  class="w-20 border-0 " id="${item.id}" style="padding:7px; font-size: 12px; font-weight: 500; width: 300px;border: unset;" value="${item.id}">
                    ${item.title}</p>
                    </li>`
            )
        });
    }
    // page.elements.formUpdateSupplier.validate({
    //     rules: {
    //         fullName: {
    //             required: true,
    //         },
    //         supplierCode: {
    //             required: true,
    //         },
    //     },
    //     messages: {
    //         fullName: {
    //             required: "Tên nhà cung cấp không được để trống",
    //         },
    //         supplierCode: {
    //             required: "Mã nhà cung cấp không được để trống",
    //         },
    //     },
    //     submitHandler: () => {
    //         doUpdateSupplier();
    //     }
    // })


    // page.dialogs.elements.formCreateGroup.validate({
    //     rules: {
    //         groupTitleSup: {
    //             required: true,
    //         },
    //     },
    //     messages: {
    //         groupTitleSup: {
    //             required: "Tên nhóm nhà cung cấp không được để trống",
    //         },
    //     },
    //     submitHandler: () => {
    //         doCreateGroupSupplier();
    //     }
    // })

    getAllEmployeeSelect();
    getAllPaymentMethodSelect();
    getAllGroup();
    searchGroup();
    $(() => {

    })

</script>

</html>