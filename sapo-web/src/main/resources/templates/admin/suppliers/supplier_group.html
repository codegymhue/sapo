<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="sapo-menu-expand sapo-menu-toggle-active" lang="vi-VN">
<head>
  <meta charset="utf-8" />
  <link rel="icon" type="image/x-icon" href="/assets/admin/images/favicon.ico"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/izitoast@1/dist/css/iziToast.min.css">
  <script>
    var CKEDITOR_BASEPATH = '/v2/lib/ckeditor/';
    var S_LANG = 'vi-VN';
    var S_LANG_RES = 'https://sapo.dktcdn.net/sapo-frontend-x/d9ad77d.i18n_vi-VN.json';
  </script>
  <script src="https://sapo.dktcdn.net/sapo-frontend-x/1bca3f4.client.bundle.js"></script>
  <link rel="stylesheet" href="https://sapo.dktcdn.net/sapo-frontend-x/6386cc5.main.css" />
  <script src="https://sapo.dktcdn.net/fe-cdn-production/lib/wootric/wootric-sdk.js"></script>
  <script src="https://sapo.dktcdn.net/fe-cdn-production/lib/upload-files/jquery.multifile.js"></script>

  <link href="https://sapo.dktcdn.net/fe-cdn-production/lib/driver/driver.min.css?v=20220218" rel="stylesheet" />

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
          crossorigin="anonymous"></script>
  <script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1081489, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script>
  <style>
    /*.modal-backdrop {*/
    /*  position: unset!important;*/
    /*}*/
  </style>

</head>
<body class="body_dashboard partners suppliergroups index">
<div id="container">
  <div class="hidden" context="tenantInfo" define="{tenantInfo: new Components.TenantInfo(this,{&quot;countries&quot;:{&quot;countryId&quot;:201}})}"></div>
  <div class="header-mobile">
    <a href="javascript:" class="icon-menu visible-xs visible-sm" onclick="showMenu()">
      <svg class="next-icon next-icon--size-20">
        <use xlink:href="#icon-menu" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
      </svg>
    </a>
  </div>
  <th:block th:replace="/layout/supplier/menu :: menu"/>
  <div class="col-right">
    <div class="col-right_content" id="content">
      <header class="ui-title-bar-container ui-title-bar-container--index">
        <div class="ui-title-bar" style="min-height:0px;" href="javascript:void(0)">
          <div class="ui-title-bar__navigation">
            <div class="ui-breadcrumbs">
              <a href="/admin/suppliers">
                <svg class="next-icon next-icon--size-20 next-icon--no-nudge">
                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#chevron-left-thinner"></use>
                </svg>
                <span class="ui-breadcrumb__item">Nhà cung cấp</span>
              </a>
            </div>
          </div>
          <div class="ui-title-bar__main-group">
            <div class="ui-title-bar__heading-group">
              <h1 class="ui-title-bar__title" style="float:left; width: unset">Nhóm nhà cung cấp</h1>
              <div class="pull-right">
                <style>
                  .help-dashboard .help-dropdown .btn-blank {
                    background: #fff url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA39pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplN2MwNTFiZi1lNGJiLTNjNDktOGM3YS00NTZmZTZlNGQ1NmYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RjI5NDdDQ0NGMUY1MTFFODhFOTZCNjZBNjQxRjJFNzUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RjI5NDdDQ0JGMUY1MTFFODhFOTZCNjZBNjQxRjJFNzUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjdkNDRhZTRlLTIzMTMtYTE0ZC1hNWQ4LTA5YTVjYTBmNmM0NCIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjk3N2NmYTliLThmZDctZGU0Mi1hNDFiLWIwOTJiYzRkYWM2MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Po5ReOIAAAIxSURBVHjalJU9aFNRGIbTk+sSh0xiEKciaBF1culiA2IdOlQHaRBKqEurYJYOFn9Ql7iJghQcSqlDAop0yFIoWJcigouKKIROClWnomaQVHw+eAPxcs7J9cDDhXvP997vfH9naPbybC6wEpiASRiFYcjDLmzBJqxCa/HRYtcn4ALCFWjDQ/gGNRiB/XrW9N6+t+euzFV8IkMpzwuwDGNwDVagmwsvO9003IMNqHKKjs9zE16Dg3AclgYI2+oitqT9ZrfGKQo+8WXF9DRs5/5j8YNt2eWl8494RaE4Dx1f+OAwnIRi4Acd2Y/1cuAUt7pi7PP4GLyHj/AavsPNyAlMp84PEqdyc0qer5oa8AuOQAnuw10YD0RpRXYTTnXcDCTvBByVp5/gK1yH33Am4H1XepNODfIi4MUPuANv+t7tgz3wM5Jj0xtN1HntwCZ7fztVrk3F/XFE3OyGE5XPToaKs33PlOBT8CWy1/TyTrOimEH8IpyFc/BuwF7T23UaQocyiJfhA7zMsNf0tpymWzmDwROYz9i0prfpNDan1EyxtRcODFK15pHeqom34I+mW2xdglsZvJ6WXsupeRY0NksRoxvyKOZ1SToL1ky9wdXQPH6uWvYtmy+vIsIF2W8g3EiP3KrKcn3ACUIer8u+6pvnHQ2jz/AWZjIkOUF4RvvNbrz/Jkob24cLmu91tX5Ts6KtziuqjsvKgSWv1gtF+g70Ldv4tO/2fxC4/a/Gbv+/AgwA9q+ezeP4kToAAAAASUVORK5CYII=') no-repeat center center;
                    border: none;
                    font-size: 0;
                    box-shadow: none;
                    margin-left: 0;
                    height: 61px;
                    width: 60px;
                    border: 1px solid #dbdbdb;
                    outline: none;
                    border-radius: 0;
                  }

                  .help-dashboard .help-dropdown .help-popup {
                    top: 60px;
                    box-shadow: #c6c6c6 0px 3px 5px 0px;
                  }

                  .help-dashboard .help-dropdown .help-popup:after {
                    right: 20px;
                  }

                  .help-dropdown {
                    position: relative;
                    margin-left: 10px;
                    height:36px;
                  }
                  .help-dropdown a {
                    color: #686868;
                    display: flex;
                    height: 100%;
                    border: none;
                    flex-direction: row;
                    justify-content: center;
                    align-items: center;
                    cursor: pointer;
                    border: 1px solid #c4cdd5;
                    float: right;
                    width: auto;
                  }

                  .help-dropdown div:hover {
                    background-color: #e7f2ff;
                  }

                  .help-dropdown .btn-blank:focus {
                    box-shadow: none;
                    border: 1px solid #c4cdd5;
                  }

                  .help-dropdown .help-popup {
                    position: absolute;
                    right: 0;
                    z-index: 9999999;
                    top: 45px;
                    box-shadow: #c6c6c6 0 0 10px 5px;
                    display: none;
                    -webkit-transition: ease 0.5s; /* Safari */
                    transition: ease 0.5s;
                  }

                  .help-dropdown .help-popup.shown {
                    display: block;
                    height: 560px;
                    margin-top: 15px;
                  }

                  .help-dropdown .help-popup:after {
                    content: "";
                    display: block;
                    width: 0px;
                    height: 0px;
                    border-left: 10px solid transparent;
                    border-right: 10px solid transparent;
                    border-bottom: 10px solid #f3f6f8;
                    top: -9px;
                    position: absolute;
                    right: 25px;
                  }
                </style>
                <div class="header-fr help-dropdown">
                  <a class="btn sapo-btn-blank btn-help" onclick="showHelpPopup()"><img src="/v2/images/dashboard/icons8-help-20.png" style="padding-right: 5px;" /><span>Trợ giúp</span></a>
                  <div class="help-popup">
                    <iframe id="iframe-help" src="" style="width: 400px; height: 560px;border:none"></iframe>
                    <input type="hidden" id="iframe-help-src" value="https://support.sapo.vn?ver=2&amp;view=pos&amp;url=http://luong5chuc.mysapogo.com/admin/supplier_groups" />
                  </div>
                </div>

                <a id="showCreateGroup" class="btn sapo-btn-default">Thêm nhóm nhà cung cấp</a>

              </div>
            </div>
          </div>
        </div>
      </header>
      <th:bock th:replace="/admin/suppliers/modals/groups/create_group_supplier :: create_group_supplier"/>

      <th:bock th:replace="/admin/suppliers/modals/groups/edit_group_supplier :: edit_group_supplier"/>

      <th:bock th:replace="/admin/suppliers/modals/groups/delete_group_supplier :: delete_group_supplier"/>

      <div class="gird-layout gird-layout--full-width">
        <section class="grid-card">
          <div id="resultFilter">
            <div class="shipments" context="indexSupplierGroup" define="{indexSupplierGroup: new Components.SupplierGroup.IndexSupplierGroup(this,{&quot;supplierGroups&quot;:[{&quot;id&quot;:2671410,&quot;tenantId&quot;:693196,&quot;type&quot;:&quot;supplier&quot;,&quot;name&quot;:&quot;Bán Theo Tấn&quot;,&quot;nameTranslate&quot;:&quot;Bán Theo Tấn&quot;,&quot;createdOn&quot;:&quot;2023-02-15T04:37:12Z&quot;,&quot;modifiedOn&quot;:&quot;2023-02-15T04:37:12Z&quot;,&quot;status&quot;:&quot;active&quot;,&quot;code&quot;:&quot;STN00004&quot;,&quot;note&quot;:&quot;&quot;,&quot;countSupplier&quot;:1,&quot;isDefault&quot;:false},{&quot;id&quot;:2671385,&quot;tenantId&quot;:693196,&quot;type&quot;:&quot;supplier&quot;,&quot;name&quot;:&quot;Bán Buôn&quot;,&quot;nameTranslate&quot;:&quot;Bán Buôn&quot;,&quot;createdOn&quot;:&quot;2023-02-15T04:27:26Z&quot;,&quot;modifiedOn&quot;:&quot;2023-02-15T04:27:26Z&quot;,&quot;status&quot;:&quot;active&quot;,&quot;code&quot;:&quot;STN00003&quot;,&quot;note&quot;:&quot;&quot;,&quot;countSupplier&quot;:1,&quot;isDefault&quot;:false},{&quot;id&quot;:2669318,&quot;tenantId&quot;:693196,&quot;type&quot;:&quot;supplier&quot;,&quot;name&quot;:&quot;Bán Lẻ&quot;,&quot;nameTranslate&quot;:&quot;Bán Lẻ&quot;,&quot;createdOn&quot;:&quot;2023-02-14T01:29:16Z&quot;,&quot;modifiedOn&quot;:&quot;2023-02-14T01:29:16Z&quot;,&quot;status&quot;:&quot;active&quot;,&quot;code&quot;:&quot;STN00002&quot;,&quot;note&quot;:&quot;&quot;,&quot;countSupplier&quot;:1,&quot;isDefault&quot;:false},{&quot;id&quot;:2669297,&quot;tenantId&quot;:693196,&quot;type&quot;:&quot;supplier&quot;,&quot;name&quot;:&quot;DEFAULT&quot;,&quot;nameTranslate&quot;:&quot;Khác&quot;,&quot;createdOn&quot;:&quot;2023-02-14T01:21:10Z&quot;,&quot;modifiedOn&quot;:&quot;2023-02-14T01:21:10Z&quot;,&quot;status&quot;:&quot;active&quot;,&quot;code&quot;:&quot;MACDINH&quot;,&quot;note&quot;:null,&quot;countSupplier&quot;:1,&quot;isDefault&quot;:true}],&quot;supplierGroup&quot;:null,&quot;pageModel&quot;:{&quot;firstItem&quot;:0,&quot;hasNextPage&quot;:false,&quot;displayFormat&quot;:false,&quot;hasPreviousPage&quot;:false,&quot;lastItem&quot;:0,&quot;pageNumber&quot;:1,&quot;pageSize&quot;:20,&quot;totalRecords&quot;:4,&quot;totalPages&quot;:1,&quot;numAroundPages&quot;:0,&quot;classActive&quot;:null,&quot;classFirst&quot;:null,&quot;classPrev&quot;:null,&quot;classNext&quot;:null,&quot;classLast&quot;:null,&quot;themes&quot;:null,&quot;filePath&quot;:null,&quot;pageQueryName&quot;:null},&quot;query&quot;:&quot;&quot;,&quot;page&quot;:1,&quot;limit&quot;:20,&quot;totalPage&quot;:1,&quot;status&quot;:null,&quot;id&quot;:0,&quot;isShowPopupEdit&quot;:false})}">
              <div class="ui-type-container clearfix">
                <div class="table-wrapper">
                  <table class="sapo-table bulk-action-context">
                    <thead class="thead">
                    <tr class="tr">
                      <th class="select th select--bulk-action" nameth="bulk_action" style="display:none">
                        <div class="bulk-actions-tooltip-wrapper bulk-actions-wrapper-main" data-toggle="tooltip" data-placement="right" title="Chọn tất cả ">
                          <div class="tooltip--select-all">
                            <div class="next-input-wrapper bulk-actions--select-all" style="left: auto;">
                              <label class="bulk-actions--select-all-btn btn hidden">
                              </label>
                              <input type="checkbox" class="next-checkbox bulk-actions--select-all-checkbox" bind-event-click="addOrRemoveAllBulkActionItems(this)">
                              <span class="next-checkbox--styled">
                                                                <svg class="next-icon next-icon--size-10 checkmark"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-checkmark-thick"></use> </svg>
                                                                <svg class="next-icon next-icon--size-10 indeterminate"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-minus"></use> </svg>
                                                            </span>
                            </div>
                          </div>
                        </div>
                      </th>
                      <th class="th">Tên nhóm</th>
                      <th class="th">Mã nhóm</th>
                      <th class="th">Ghi chú</th>
                      <th class="th align-center">Số lượng nhà cung cấp</th>
                      <th class="th">Ngày tạo</th>
                    </tr>
                    </thead>
                    <tbody class="tbody" id="tbListGroupSupplier">
                    </tbody>
                  </table>
                </div>
                <div class="t-grid-pager-boder" value="/admin/supplier_groups" query="">
                  <div class="t-pager t-reset"><div class="col-4"><div class="t-status-text dataTables_info">Hiển thị kết quả từ 1 - 4 trên tổng 4</div></div></div>
                </div>
                <div define="{products_match_current_search: 4}"></div>
              </div>
            </div>
          </div>
        </section>
      </div>
      <div class="grid-footer-help">
        <div class="grid-footer-help__content">
          <div class="grid-footer-help__icon">
            <svg class="next-icon next-icon--size-24 next-icon--no-nudge" role="img" aria-labelledby="next-help-circle-title">
              <title id="next-help-circle-title">Help</title>
              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-help-circle"></use>
            </svg>
          </div>
          <div>
            Bạn có thể xem thêm hướng dẫn về quản lý nhóm nhà cung cấp <a target="_blank" style="color:#0088ff" title="Hướng dẫn" href="https://support.sapo.vn/huong-dan-tao-nhom-nha-cung-cap">tại đây</a>
          </div>
        </div>
      </div>

    </div>
    <div class="popup-box">
      <iframe scrolling="no" src="about:blank" name="myIframe" id="popupPrint" style="border:0;position:absolute;width:0px;height:0px;left:0px;top:0px;"></iframe>
    </div>
  </div>
</div>
<div class="section-footer">

</div>
<div class='container-fluid-md notifications'><div class='ajax-notification'><span class='ajax-notification-message'></span></div></div>
<div class="modal fade" id="sapo-modal-container" data-width="" tabindex="-1" role="dialog" data-backdrop="false"></div>
<div class="modal-backdrop fade in" id="sapo-modal-backdrop"></div>


<style>
  #surveys {
    position: fixed;
    bottom: 0;
    width: calc(100% - 23rem);
    right: 0;
    z-index: 999999
  }

  .sapo-menu-collapse #surveys {
    width: calc(100% - 5.6rem) !important;
  }
</style>
<div id="surveys"></div>

<script>
  Page();
  hj('trigger', 'split_test_b');
</script>

<div context="notificationVNPay" define="{notificationVNPay: new Components.NotificationVNPay(this, {accountId:951061 })}">
  <div class="popup-notification">
    <a href="javascript:" bind-event-click="closeNoti()" class="close">
      <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#cancel-small-minor"></use></svg>
    </a>
    <a href="" target="_blank" class="link-order">
      <img class="left" src="/v2/images/ico-sapo.png" />

    </a>
    <a href="" target="_blank" class="link-order">
      <div class="title left">Thanh toán đơn hàng</div>
      <div class="desc left"></div>
    </a>
  </div>
</div>

</body>
<th:block th:replace="/layout/script :: script"/>
<script src="/assets/admin/js/suppliers/supplier_app.js"></script>
<script src="/assets/admin/js/suppliers/jquery/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/izitoast@1/dist/js/iziToast.min.js" type="text/javascript"
        crossorigin></script>

<script>
  const page = {
    urls: {
      getAllGroup : origin +"/api/supplier_groups",
      doCreateGroupSupplier: origin +"/api/supplier_groups/create",
      showEditGroupSup: origin +"/api/supplier_groups/",
      doEditGroupSupplier: origin +"/api/supplier_groups/",
      btnShowDeleteGroupSupplier: origin +"/api/supplier_groups/",
      btnGroupSupDelete: origin +"/api/supplier_groups/",
    },
    elements: {},
    commands: {},
    dialogs: {
      elements: {},
      commands: {}
    }
  }

  page.elements.tbListGroupSupplier = $("#tbListGroupSupplier")
  page.elements.showCreateGroup = $("#showCreateGroup");
  page.dialogs.elements.formCreateGroup = $("#formCreateGroup");

  page.dialogs.elements.modalCreateGroupSupplier= $("#modalCreateGroupSupplier");
  page.dialogs.elements.btnCreateGroupSupplier = $("#btnCreateGroupSupplier");
  page.dialogs.elements.groupCreateId =  $("#groupCreateId");
  page.dialogs.elements.groupCreateTitleSup =  $("#groupCreateTitleSup");
  page.dialogs.elements.groupCreateCodeSup =  $("#groupCreateCodeSup");
  page.dialogs.elements.groupCreateDescriptionSup =  $("#groupCreateDescriptionSup");

  page.dialogs.elements.groupTitleEditSup =  $("#groupTitleEditSup");
  page.dialogs.elements.groupCodeEditSup =  $("#groupCodeEditSup");
  page.dialogs.elements.groupDescriptionEditSup =  $("#groupDescriptionEditSup");

  page.dialogs.elements.formEditGroup = $("#formEditGroup");
  page.elements.showModalEditGroupSupplier = $("#showModalEditGroupSupplier");
  page.dialogs.elements.editGroupId = $("#editGroupId");
 page.dialogs.elements.editGroupSupplier =  $("#editGroupSupplier");

 page.dialogs.elements.btnShowModalDeleteGroupSupplier = $("#btnShowModalDeleteGroupSupplier");
 page.dialogs.elements.modalDeleteGroupSup  = $("#modalDeleteGroupSup")
 page.dialogs.elements.btnGroupSupDelete = $("#btn-group-sup-delete");

function renderGroup(item) {
  return `
         <tr id="tr_${item.id}" onclick="showEditGroupSup(${item.id})" data-id="${item.id}">
                      <td class="select td bulk-action" nametd="bulk_action" style="display:none">
                        <div class="next-input-wrapper">
                          <input type="checkbox" value="2671410" class="bulk-action-item next-checkbox">
                          <span class="next-checkbox--styled"><svg class="next-icon next-icon--size-10 checkmark"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-checkmark-thick"></use> </svg></span>
                        </div>
                      </td>
                      <td class="cursor-pointer">
                        <span>${item.title}</span>
                      </td>
                      <td class="cursor-pointer">
                        <span>${item.supGroupCode}</span>
                      </td>
                      <td class="cursor-pointer"
                      </td>
                      <td class="align-center cursor-pointer">
                        1
                        </td>
                      <td class="cursor-pointer">
                    ${moment(item.createdAt).format('L')}
                      </td>
                    </tr>
  `
}
  function getAllGroup() {
    $.ajax({
      "headers": {
        "accept": "application/json",
        "content-type": "application/json"
      },
      type: "GET",
      url: page.urls.getAllGroup,
    })
            .done((data) => {
              console.log("da get all : " , data)
              supplierGroups = data;
              $.each(data, function (index, value) {
                let str= renderGroup(value);
                page.elements.tbListGroupSupplier.prepend(str);
              });
            })
  }
    page.elements.showCreateGroup.on('click', ()=> {
    page.dialogs.elements.modalCreateGroupSupplier.modal('show');
    page.dialogs.elements.groupCreateId.val("");
    page.dialogs.elements.groupCreateTitleSup.val("");
    page.dialogs.elements.groupCreateCodeSup.val("");
    page.dialogs.elements.groupCreateDescriptionSup.val("");
  })

    page.dialogs.elements.btnCreateGroupSupplier.on('click', () => {
    page.dialogs.elements.formCreateGroup.trigger("submit");
  })
  function doCreateGroupSupplier() {
    let supGroupCode = page.dialogs.elements.groupCreateCodeSup.val();
    let supGroupTitle = page.dialogs.elements.groupCreateTitleSup.val();
    let description = page.dialogs.elements.groupCreateDescriptionSup.val();
    let newGroupSup =
    {
      title: supGroupTitle.length > 0 ? supGroupTitle : undefined,
      supGroupCode: supGroupCode.length > 0 ? supGroupCode : undefined,
      description: description.length > 0 ? description : undefined,
    }
    console.log("trc ajax", newGroupSup)
    $.ajax({
      "headers": {
        "accept": "application/json",
        "content-type": "application/json"
      },
      "type": "POST",
      "url": page.urls.doCreateGroupSupplier,
      "data": JSON.stringify(newGroupSup)
    })
            .done((data) => {
              SupplierApp.IziToast.showSuccessAlert("Thêm nhóm nhà cung cấp thành công!");
              let str= renderGroup(data)
              page.elements.tbListGroupSupplier.prepend(str);
              page.dialogs.elements.modalCreateGroupSupplier.modal('hide');
            })
            .fail((jqXHR) => {
              SupplierApp.IziToast.showErrorAlert("Nhóm nhà cung cấp đã tồn tại!");
            })
  }

  function showEditGroupSup(item) {
    console.log(" id: " + item)
    $.ajax({
      "headers": {
        "accept": "application/json",
        "content-type": "application/json"
      },
      type: "GET",
      url: page.urls.showEditGroupSup + item,
    })
            .done((data) => {
              let idGroupMacDinh = 252;
              if (data.id == idGroupMacDinh){
                page.elements.showModalEditGroupSupplier.modal('show');
                page.dialogs.elements.btnShowModalDeleteGroupSupplier.hide(),
                page.dialogs.elements.editGroupId.val(data.id),
                page.dialogs.elements.groupTitleEditSup.val(data.title),
                page.dialogs.elements.groupCodeEditSup.val(data.supGroupCode),
                page.dialogs.elements.groupDescriptionEditSup.val(data.description)
              }else {
                console.log("data show edit: ", data)
                page.elements.showModalEditGroupSupplier.modal('show');
                page.dialogs.elements.btnShowModalDeleteGroupSupplier.show(),
                page.dialogs.elements.editGroupId.val(data.id),
                page.dialogs.elements.groupTitleEditSup.val(data.title),
                page.dialogs.elements.groupCodeEditSup.val(data.supGroupCode),
                page.dialogs.elements.groupDescriptionEditSup.val(data.description)
              }
            })
            .fail(()=>{
              SupplierApp.IziToast.showErrorAlert("Không tìm thấy nhóm nhà cung cấp!");
            })
  }

  page.dialogs.elements.editGroupSupplier.on('click',()=> {
    page.dialogs.elements.formEditGroup.trigger("submit");
  })

  function doEditGroupSupplier() {
    let idEditGroup = page.dialogs.elements.editGroupId.val();
    let editGroupTitle = page.dialogs.elements.groupTitleEditSup.val();
    let supGroupCode = page.dialogs.elements.groupCodeEditSup.val();
    let description = page.dialogs.elements.groupDescriptionEditSup.val();
    let editGroup = {
      id: idEditGroup,
      title: editGroupTitle.length > 0 ? editGroupTitle : undefined,
      supGroupCode: supGroupCode.length > 0 ? supGroupCode : undefined,
      description: description.length > 0 ? description : undefined
    }
    $.ajax({
      "headers": {
        "accept": "application/json",
        "content-type": "application/json"
      },
      type: "PATCH",
      url: page.urls.doEditGroupSupplier + idEditGroup,
      data: JSON.stringify(editGroup)
    })
            .done((data)=>{
              console.log("btn data : ", data)
              SupplierApp.IziToast.showSuccessAlert("Sửa nhóm nhà cung cấp thành công!");
              page.elements.showModalEditGroupSupplier.modal('hide');
              $(`#tr_${data.id}`).replaceWith(renderGroup(data))
            })
            .fail((jqXHR) => {
              SupplierApp.IziToast.showErrorAlert("Nhóm nhà cung cấp đã tồn tại!");

            })
  }

  page.dialogs.elements.btnShowModalDeleteGroupSupplier.on('click', () => {
            let idDelete = page.dialogs.elements.editGroupId.val();
            console.log("idDelete: ", idDelete)
            $.ajax({
              "headers": {
                "accept": "application/json",
                "content-type": "application/json"
              },
              type: "GET",
              url: page.urls.btnShowDeleteGroupSupplier + idDelete,
            })
                    .done((data) => {
                      console.log("data-delete : ", data)
                      page.elements.showModalEditGroupSupplier.modal('hide');
                      page.dialogs.elements.modalDeleteGroupSup.modal('show');
                    })
          })

  page.dialogs.elements.btnGroupSupDelete.on('click', ()=> {
    let idDelete = page.dialogs.elements.editGroupId.val();
    console.log("idDelete btn :" , idDelete)
    $.ajax({
      "headers": {
        "accept": "application/json",
        "content-type": "application/json"
      },
      type: "DELETE",
      url: page.urls.btnGroupSupDelete + idDelete,
    })

   .done(()=>{
              SupplierApp.IziToast.showSuccessAlert("Xoá nhóm nhà cung cấp thành công!");
              // location.reload();
              window.location.href = `/admin/supplier_groups`;
            })

  .fail(()=> {
              SupplierApp.IziToast.showErrorAlert("Xoá nhóm nhà cung cấp thất bại!");
            })
  })

  page.dialogs.elements.formCreateGroup.validate({
    rules: {
      groupTitleSup: {
        required: true,
      },
    },
    messages: {
      groupTitleSup: {
        required: "Vui lòng nhập tên nhóm nhà cung cấp",
      },
    },
    submitHandler:() => {
      doCreateGroupSupplier();
    }
  })

  page.dialogs.elements.formEditGroup.validate({
    rules: {
      groupTitleEditSup: {
        required: true,
      },
    },
    messages: {
      groupTitleEditSup: {
        required: "Vui lòng nhập tên nhóm nhà cung cấp",
      }
    },
    submitHandler:() => {
      doEditGroupSupplier();
    }
  })

  getAllGroup();

</script>
</html>
